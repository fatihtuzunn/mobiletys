rule exploit_binder_cve_2019_2215_fp_strict
{
    meta:
        description = "CVE-2019-2215 Binder exploit shellcode"
        cve = "CVE-2019-2215"
        severity = "Critical"
        reference = "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-2215"

    strings:
        $payload = "writev(binder_fd, &write, sizeof(write)) failed"
        $known_string = "binder_thread_write+0x2a0"
    condition:
        all of them
}

rule exploit_dirtycow_fp_strict
{
    meta:
        description = "Dirty COW Exploit (CVE-2016-5195) - exact signature"
        cve = "CVE-2016-5195"
        severity = "Critical"
        reference = "https://dirtycow.ninja"

    strings:
        $unique = "dirtycow.c by firefart"
        $madvise_thread = "madviseThread started"
        $ptrace_thread = "ptraceThread started"

    condition:
        all of them
}
rule exploit_cve_2021_0316
{
    meta:
        description = "CVE-2021-0316 medya framework bellek taşması saldırısı"
        cve = "CVE-2021-0316"
        severity = "High"

    strings:
        $crashlog = "libmediaplayerservice"
        $decoder = "OMX.google.h264.decoder"
        $log = "frameworks/av/media/libstagefright/"

    condition:
        all of them
}
